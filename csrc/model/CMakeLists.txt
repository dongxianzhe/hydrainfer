include(cc_library)
include(cc_test)

cc_library(
  NAME 
    models
  HDRS
    models.h
  SRCS
    models.cpp
    position_embed.cpp
  DEPS
    :memory
    :kernels
    :state_dict
    :flash_attn.kernels
    glog::glog
    torch
  COPTS
    -fPIC
)

cc_test(
  NAME
    model_test
  SRCS
    model_test.cpp
  DEPS
    :models
    GTest::gtest_main
    glog::glog
    torch
)

cc_test(
  NAME
    fake_model_test
  HDRS
    fake_model.h
  SRCS
    fake_model_test.cpp
  DEPS
    :state_dict
    GTest::gtest_main
    glog::glog
    torch
)